description "load-balancing and high availability service / BACK UP"

vrrp_script check_haproxy {       #health check du haproxy
    script "pidof haproxy"      #Demande toutes les 2 sec, le pid du haproxy
    interval 2
}

vrrp_instance VI_1 {    #configuration sur comment keepalived implément la haute dispo
    state BACKUP    #Serveur auxiliaire
    priority 100

    virtual_router_id 33    #ID du cluster pour les 2 LB
    unicast_src_ip 192.168.0.34     #unicast des 2 adresses IP
    unicast_peer {
        192.168.0.33
    }

    authentification {          #On met une authentification pour que le 2e LB communique avec le 1er
        auth_type PASS
        auth_pass password
    }

    track_script {          #On vérifier le bon fonctionnement du système local
        check_haproxy
    }

    notify_master /etc/keepalived/master.sh #Script qui notifie quand un des LB devient maitre de la paire       
}